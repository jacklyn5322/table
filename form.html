<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>æ’¿æ‹¾è¸è’‚é‡é‡å›å ±è¡¨å–®</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; max-width: 500px; margin: auto; }
    label { display: block; margin-top: 1rem; }
    select, input { width: 100%; padding: 0.5rem; font-size: 1rem; margin-top: 0.5rem; }
    button { margin-top: 2rem; padding: 0.75rem; width: 100%; font-size: 1.1rem; }
    #status { margin-top: 1rem; font-weight: bold; }
    #partnerNameField { display: none; }
  </style>
</head>
<body>
  <h2>æ’¿æ‹¾è¸è’‚é‡é‡å›å ±è¡¨å–®</h2>
  <label>å€åŸŸï¼š<select id="region"></select></label>
  <label>å°å€ï¼š<select id="subregion"></select></label>
  <label>åˆ†æœƒï¼š<select id="chapter"></select></label>
  <label>æ’¿æ‹¾é‡é‡ï¼ˆå…¬æ–¤ï¼‰ï¼š<input type="number" id="weightKg" min="0" step="0.01" /></label>

  <!-- åˆä½œå–®ä½ç›¸é—œæ¬„ä½ -->
  <label>æ˜¯å¦æœ‰åˆä½œå–®ä½ï¼š
    <select id="hasPartner" onchange="togglePartnerField()">
      <option value="">è«‹é¸æ“‡</option>
      <option value="æ˜¯">æ˜¯</option>
      <option value="å¦">å¦</option>
    </select>
  </label>
  <div id="partnerNameField">
    <label>åˆä½œå–®ä½åç¨±ï¼ˆå¯è¼¸å…¥ä¸­è‹±æ–‡ï¼‰ï¼š<input type="text" id="partnerName" /></label>
  </div>

  <!-- ğŸ”¼ æ–°å¢ä¸Šå‚³åœ–ç‰‡å½±ç‰‡æ¬„ä½ -->
  <label>ä¸Šå‚³åœ–ç‰‡æˆ–å½±ç‰‡ï¼ˆå¯å¤šç­†ï¼‰ï¼š<input type="file" id="mediaFiles" multiple /></label>

  <button onclick="handleSubmit()">é€å‡º</button>
  <div id="status"></div>

  <script>
    const data = {
      "æ±å€": {"èŠ±æ±ç¸£å¸‚å€": ["èŠ±è“®", "å…‰å¾©", "å°æ±"]},
      "åŒ—å€": {
        "åŸºå®œç¸£å¸‚å€": ["åŸºéš†", "ç¾…æ±", "è˜‡æ¾³æ¸¯", "å®œè˜­", "é ­åŸ", "é›¨æ¸¯", "å››ç¶­", "é›ç± å±±"],
        "å°åŒ—å¸‚å€": ["å°åŒ—å¸‚", "é¦–åºœ", "é™½æ˜å±±", "å°åŒ—å¥³", "å¤§å®‰", "é•·æ˜¥", "ä¸­å±±", "å››æµ·", "é¾å±±", "å¤§åŒ", "å£«æ—", "åŒ—æŠ•", "å¤§æ¾å±±", "æ–‡å±±", "åŸä¸­"],
        "æ–°åŒ—å¸‚å€": ["æ°¸å’Œ", "ä¸‰é‡", "æ–°èŠ", "æ¿æ©‹", "ä¸­å’Œ", "æ–°åŒ—", "æ¨¹æ—", "åœŸåŸ", "æ³°å±±", "æ·¡æ°´", "ä¸‰å³½", "é¶¯æ­Œ", "è˜†æ´²", "æ–°åº—", "é›™å’Œ", "æ±æ­¢", "æ±ç§‘"]
      },
      "æ¡ƒç«¹è‹—å€": {
        "æ¡ƒåœ’å¸‚å€": ["æ¡ƒåœ’", "ä¸­å£¢", "æ¥Šæ¢…", "å¹³é®", "é¾æ½­", "å¤§æºª", "è™é ­å±±", "æ¡ƒåœ’å¥³", "å¤§åœ’", "å…«å¾·", "ä¸€å¾·", "åŸ”å¿ƒ"],
        "ç«¹è‹—ç¸£å¸‚å€": ["æ–°ç«¹", "è‹—æ —", "ç«¹æ±", "æ–°ç«¹å¥³", "å±±åŸ", "ç«¹åŒ—", "é ­ä»½", "é¢¨åŸ", "æ¹–å£"]
      },
      "ä¸­å€": {
        "å°ä¸­å¸‚ä¸€å€": ["å°ä¸­", "å¤§å¢©", "åˆä½œ", "è‡ºä¸­å¥³", "äºå“¥", "ä¸­å‹", "æ–‡åŒ–åŸ", "æ–‡å¿ƒ", "è‹±æ‰", "æ±å³°"],
        "å°ä¸­å¸‚äºŒå€": ["è±åŸ", "å°ä¸­æ¸¯", "æ½­å­", "å¤§ç”²", "æ²™é¹¿", "å¤§é‡Œ", "éœ§å³°", "å¤§é›…", "æ±å‹¢", "å¤ªå¹³", "å¤ªå¹³å¥³", "åé‡Œ", "æ¢§æ£²", "å¤–åŸ”", "ç¥å²¡", "é¾äº•"],
        "å½°åŒ–ç¸£å¸‚å€": ["å½°åŒ–", "å“¡æ—", "äºŒæ—", "åŒ—æ–—", "æºªæ¹–", "é¹¿æ¸¯", "ç”°ä¸­", "ä¸­æ­£", "å’Œç¾", "èŠ±å£‡", "å¤§å½°"],
        "å—æŠ•ç¸£å¸‚å€": ["å—æŠ•", "åŸ”é‡Œ", "ç«¹å±±", "æ°´é‡Œ", "è‰å±¯", "åé–“", "å—æŠ•å¥³", "å—å´—"]
      },
      "å—å€": {
        "é›²å˜‰ç¸£å¸‚å€": ["å˜‰ç¾©", "é›²æ—", "è™å°¾", "è¥¿èº", "åŒ—æ¸¯", "æ°‘é›„", "ç‰å±±", "å¤§æ—", "è¿æ¡"],
        "å°å—å¸‚å€": ["å°å—", "æ–°åŒ–", "æˆåŠŸ", "é³³å‡°åŸ", "æ–°ç‡Ÿ", "ä»å¾·", "åºœåŸ", "æ°¸åº·", "å®‰å—", "å°å—å¥³", "å¤éƒ½", "é‡‘åŸ", "å—ç§‘", "èè‹±"],
        "é«˜å¸‚é‡‘æ¾å€": ["é«˜é›„", "æ¾æ¹–", "å·¨æ¸¯", "é«˜é›„å¥³", "åšæ„›", "è¥¿å­ç£", "å·¦ç‡Ÿ", "æ˜¥ç§‹é–£", "é‡‘é–€", "æŸ´å±±", "å—æ˜Ÿ", "é«˜éƒ½"],
        "é«˜å±ç¸£å¸‚å€": ["å±æ±", "å²¡å±±", "é³³å±±", "æ½®å·", "æ±æ¸¯", "å¤§å´—å±±", "æ¼¯åº•å±±", "å¤ªé™½åŸ", "é˜¿å…¬åº—"]
      }
    };

    const regionEl = document.getElementById("region");
    const subregionEl = document.getElementById("subregion");
    const chapterEl = document.getElementById("chapter");

    for (const region in data) regionEl.options.add(new Option(region, region));

    regionEl.onchange = () => {
      subregionEl.innerHTML = chapterEl.innerHTML = "";
      const subs = Object.keys(data[regionEl.value] || {});
      subs.forEach(sr => subregionEl.options.add(new Option(sr, sr)));
      if (subs.length) {
        subregionEl.value = subs[0];
        subregionEl.onchange();
      }
    };

    subregionEl.onchange = () => {
      chapterEl.innerHTML = "";
      (data[regionEl.value]?.[subregionEl.value] || []).forEach(ch => chapterEl.options.add(new Option(ch, ch)));
    };

    function togglePartnerField() {
      const value = document.getElementById("hasPartner").value;
      document.getElementById("partnerNameField").style.display = value === "æ˜¯" ? "block" : "none";
    }

    // â¬‡ï¸ æ–°çš„ handleSubmitï¼Œæ”¯æ´å¤šæª”æ¡ˆä¸Šå‚³
    function handleSubmit() {
      const region = regionEl.value;
      const subregion = subregionEl.value;
      const chapter = chapterEl.value;
      const weightKg = parseFloat(document.getElementById("weightKg").value);
      const weight = Math.round(weightKg * 1000);
      const hasPartner = document.getElementById("hasPartner").value;
      const partnerName = document.getElementById("partnerName").value || "";
      const files = document.getElementById("mediaFiles").files;

      const formData = new FormData();
      formData.append("region", region);
      formData.append("subregion", subregion);
      formData.append("chapter", chapter);
      formData.append("weight", weight);
      formData.append("hasPartner", hasPartner);
      formData.append("partnerName", partnerName);

      for (let i = 0; i < files.length; i++) {
        formData.append("mediaFiles", files[i]);
      }

      fetch("https://script.google.com/macros/s/AKfycbx126ktqurKHWg8TmFVp0xNUApMZKpArHfH7xTeYoI02rl7B8RBOqfk2A-KeWbyXLFN5w/exec", {
        method: "POST",
        body: formData,
      })
      .then(res => res.text())
      .then(res => {
        document.getElementById("status").innerText = "âœ… å¡«å¯«æˆåŠŸ";
        document.getElementById("weightKg").value = "";
        document.getElementById("hasPartner").value = "";
        document.getElementById("partnerName").value = "";
        document.getElementById("mediaFiles").value = "";
        togglePartnerField();
      })
      .catch(() => {
        document.getElementById("status").innerText = "âŒ ç™¼é€å¤±æ•—";
      });
    }

    regionEl.selectedIndex = 0;
    regionEl.onchange();
  </script>
</body>
</html>
